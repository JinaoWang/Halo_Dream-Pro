(()=>{window.encrypt=e=>window.btoa(unescape(encodeURIComponent(e))),window.decrypt=e=>decodeURIComponent(escape(window.atob(e)));const t={initWidget(){const a=$(".column-right"),n=$(".column-right-shadow");if(a.length&&n.length){const o=$(window);function e(){var e=o.width(),t=0<n.children().length;e<1216&&!t?(a.children().detach().appendTo(n),n.addClass("is-active")):1216<=e&&t&&(n.children().detach().appendTo(a),n.removeClass("is-active"))}$(window).on("resize",function(a){let n;return function(){const e=this,t=arguments;clearTimeout(n),n=setTimeout(function(){a.apply(e,t)},50)}}(e)),e()}},initTocAndNotice(){var e=location["pathname"],t=(window.tocPjax&&window.tocPjax(),0===$(".widget.toc .card-content ul").length),e="toc"===DreamConfig.notice_show_mode&&!t||"index"===DreamConfig.notice_show_mode&&"/"!==e;t?$(".widget.toc,.action-toc").addClass("is-hidden-all"):$(".widget.toc,.action-toc").removeClass("is-hidden-all"),e?$(".widget.notice").addClass("is-hidden-all"):$(".widget.notice").removeClass("is-hidden-all")},initBanner(){const o=$(".banner-info-desc");if(0!==o.length){const i=o.text();o.text("");let t,a="",n=!0;const s=function(){var e=a.length;n&&e<i.length?(a+=i.charAt(e),o.text(a)):!n&&0<e?(a=a.slice(0,e-1),o.text(a)):(clearInterval(t),n=!n,t=setInterval(s,n?500:80))};t=setInterval(s,n?500:80)}},initGallery(){$(".main-content img:not(.not-gallery)").each(function(){var e=$(this),t=e.attr("src"),a=(e.attr("alt"),e.attr("srcset"));DreamConfig.lazy_enable&&(t&&e.attr("data-src",t),a&&e.attr("data-srcset",a),e.addClass("lazyload")),0===$(this).parents("[data-fancybox],mew-photos").length&&(DreamConfig.lazy_enable&&(e.removeAttr("src"),e.removeAttr("srcset")),$(this).wrap(`<div class="gallery-item"><div data-fancybox="gallery" data-options='{"hash": false}' ${this.alt?`data-caption="${this.alt}"`:""} href="${t}"></div></div>`))})},initMode(){let t="true"===(e=localStorage.getItem("night"))||"false"===e?"true"===localStorage.getItem("night"):"night"===DreamConfig.default_theme||"system"===DreamConfig.default_theme&&matchMedia("(prefers-color-scheme: dark)").matches;var e;$("#toggle-mode").on("click",()=>{var e;(e=!t)?$("html").addClass("color-scheme-dark").removeClass("color-scheme-light").addClass("night").attr("night",!0):$("html").addClass("color-scheme-light").removeClass("color-scheme-dark").removeClass("night").removeAttr("night"),localStorage.setItem("color-scheme",e?"dark":"light"),localStorage.setItem("special-efficacy-scheme",e?"dark":"light"),t=e,localStorage.setItem("night",t)})},initNavbar(){var t=$(".navbar-nav a"),e=$(".panel-side-menu .link");let a=0;var{href:n,pathname:o}=location;if(o&&"/"!==o)for(let e=0;e<t.length;e++){const i=t[e].getAttribute("href");if((o.includes(i)||n.includes(i))&&(a=e,o===i||n===i))break}const i=t.eq(a);i.addClass("current"),i.parents(".item-dropdown").length&&i.parents(".item-dropdown").find(".item-dropdown-link a").addClass("current"),e.eq(a).addClass("current")},searchDialog(){const t=$(".navbar-search .result");$(".navbar-search .input").on("click",function(e){e.stopPropagation(),t.addClass("active")}),$(document).on("click",function(){t.removeClass("active")})},initDropMenu(){$(".item-dropdown").each(function(e,t){var a=$(this).find(".item-dropdown-menu"),n=$(t).attr("trigger")||"click",t=$(t).attr("placement")||$(this).height()||0;a.css("top",t),"hover"===n?$(this).hover(()=>$(this).addClass("active"),()=>$(this).removeClass("active")):($(this).on("click",function(e){e.stopPropagation(),$(this).toggleClass("active"),$(document).one("click",()=>$(this).removeClass("active")),e.stopPropagation()}),a.on("click",e=>e.stopPropagation()))})},iniTaskItemDisabled(){$('li[data-type="taskItem"]').each(function(){$(this).find('label > input[type="checkbox"]').prop("disabled",!0)})},initLogonMenu(){$(".navbar-logon").each(function(e,t){"hover"===($(t).attr("trigger")||"click")?$(this).hover(()=>$(this).addClass("active"),()=>$(this).removeClass("active")):$(this).on("click",function(e){e.stopPropagation(),$(this).toggleClass("active"),$(document).one("click",()=>$(this).removeClass("active")),e.stopPropagation()})})},initScroll(){window.initTop=0,document.addEventListener("scroll",()=>{const e=$(document).scrollTop(),t=(o=e>window.initTop,window.initTop=e,o),a=$("body"),n=$(".actions");var o;50<e&&t?a.addClass("move-up"):a.removeClass("move-up"),100<e?n.addClass("show"):n.removeClass("show")})},drawerMobile(){$(".navbar-slideicon").on("click",function(e){e.stopPropagation(),$(".navbar-searchout").removeClass("active");var e=$("html"),t=$(".navbar-mask"),a=$(".navbar-slideout");a.hasClass("active")?(e.removeClass("disable-scroll"),t.removeClass("active slideout"),a.removeClass("active")):(e.addClass("disable-scroll"),t.addClass("active slideout"),a.addClass("active"))}),$(".action-toc").on("click",function(e){e.stopPropagation(),$(".navbar-searchout").removeClass("active");var e=$("html"),t=$(".navbar-mask"),a=$(".navbar-slideout");a.hasClass("active")?(e.removeClass("disable-scroll"),t.removeClass("active slideout"),a.removeClass("active slideout-toc")):(e.addClass("disable-scroll"),t.addClass("active slideout"),a.addClass("active slideout-toc"))})},back2Top(){$("#back-to-top").on("click",function(){$("body, html").animate({scrollTop:0},400)})},maskClose(){$(".navbar-mask").on("click",function(e){e.stopPropagation(),$("html").removeClass("disable-scroll"),$(".navbar-mask").removeClass("active slideout"),$(".navbar-searchout").removeClass("active"),$(".navbar-slideout").removeClass("active slideout-toc"),$(".navbar-above").removeClass("solid")}),$(".navbar .toc-content").on("click",function(e){e.stopPropagation(),$("html").removeClass("disable-scroll"),$(".navbar-mask").removeClass("active slideout"),$(".navbar-slideout").removeClass("active slideout-toc")})},sideMenuMobile(){$(".navbar-slideout-menu .current").parents(".panel-body").show().siblings(".panel").addClass("in"),$(".navbar-slideout-menu .panel").on("click",function(e){e.stopPropagation();var e=$(this),t=e.parent().parent();t.find(".panel").not(e).removeClass("in"),t.find(".panel-body").not(e.siblings(".panel-body")).stop().hide("fast"),e.toggleClass("in").siblings(".panel-body").stop().toggle("fast")})},initEvent(){var e=$("body");function a(e){var e=$(e),t=e.attr("data-close");return t&&""!==t.trim()?e.closest(t.trim()):e}e.on("click",".click-close",function(e){e.stopPropagation(),a(this).remove()}),e.on("click",".click-animation-close",function(e){e.stopPropagation();let t=a(this);t.addClass("close-animation"),setTimeout(()=>t.remove(),300)})},offscreenTip(){if(!Utils.isMobile()&&(DreamConfig.document_hidden_title||DreamConfig.document_visible_title)){let e=document.title,t=null;document.addEventListener("visibilitychange",function(){document.hidden?(DreamConfig.document_visible_title&&document.title===DreamConfig.document_visible_title||(e=document.title),document.title=DreamConfig.document_hidden_title||e,clearTimeout(t)):(document.title=DreamConfig.document_visible_title||e,DreamConfig.document_visible_title&&(t=setTimeout(function(){document.title===DreamConfig.document_visible_title&&(document.title=e)},2e3)))})}},initCarousel(){window.Swiper&&new Swiper(".swiper",{loop:!0,parallax:!0,effect:"slide",spaceBetween:10,speed:600,autoplay:{delay:3e3,disableOnInteraction:!1,pauseOnMouseEnter:!0},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})},closeFancybox(){document.querySelector(".fancybox-container")&&$.fancybox.close()},sparkInput(){const a=DreamConfig.spark_input_content&&DreamConfig.spark_input_content.filter(e=>0<e.length);a&&0<a.length&&Utils.cachedScript(DreamConfig.theme_base+"/js/spark-input.min.js?mew="+DreamConfig.theme_version,function(){$(".spark-input").each((e,t)=>sparkInput(t,[t.innerText,...a]))})},loveTime(){let c=$(".love .love-time");if(0!==c.length&&DreamConfig.love_time_template&&DreamConfig.love_time_template_year){var e=c.attr("data-time");if(/^\d{4}\/\d{2}\/\d{2} \d{2}:\d{2}:\d{2}$/.test(e)){const d=new Date(e);setInterval(function(){let e=new Date(Date.now()),t=parseInt((e-d)/1e3),a=t%60,n=(t=parseInt(t/60))%60,o=(t=parseInt(t/60))%24,i=parseInt(t/24),s=0,r=d.getFullYear(),l=e.getFullYear();for(;r<l;){if(r%4==0&&r%100!=0||r%400==0){if(i<366)break;i-=366}else{if(i<365)break;i-=365}s+=1,r+=1}0!==s?c.html(DreamConfig.love_time_template_year.replace(/\{(\d+)\}/g,(e,t)=>[s,i,o,n,a][t])):c.html(DreamConfig.love_time_template.replace(/\{(\d+)\}/g,(e,t)=>[i,o,n,a][t]))},300)}else c.text(e)}},websiteTime(){if(DreamConfig.website_time&&DreamConfig.site_time_expression){const r=document.querySelectorAll(".websiteDate");if(""!==DreamConfig.website_time&&r&&0!==r.length){const l=new Date(DreamConfig.website_time).getTime();setInterval(function(){let e=Date.now(),t=parseInt((e-l)/1e3),a=t%60,n=(1===String(a).length&&(a="0"+a),(t=parseInt(t/60))%60),o=(1===String(n).length&&(n="0"+n),(t=parseInt(t/60))%24),i=(1===String(o).length&&(o="0"+o),parseInt(t/24)),s=DreamConfig.site_time_expression.replace(/\{(\d+)\}/g,(e,t)=>`<span class="stand">${[i,o,n,a][t]}</span>`);r.forEach(e=>{e.innerHTML=s})},300)}}},webCopyright(){if(DreamConfig.website_time){var n=document.querySelectorAll(".webCopyright");if(n&&0!==n.length){let t,e=(new Date).getFullYear(),a=new Date(DreamConfig.website_time).getFullYear();t=e===a?"© "+e:"© "+a+"-"+e,n.forEach(e=>{e.innerText=t})}}},initTimeCount(){try{if(console.log("=== 开始执行人生倒计时初始化 ==="),console.log("timelife元素存在:",0<$(".timelife").length),console.log("aside-timelife元素存在:",0<$(".aside-timelife").length),console.log("当前时间:",new Date),console.log("DreamConfig存在:","undefined"!=typeof DreamConfig),"undefined"!=typeof DreamConfig&&(console.log("DreamConfig.countdown_name:",DreamConfig.countdown_name),console.log("DreamConfig.countdown_date:",DreamConfig.countdown_date)),$(".timelife").length)if($(".aside-timelife").length){console.log("找到所有必要元素，开始执行倒计时计算");let n=null;if(DreamConfig.countdown_date&&"null"!==DreamConfig.countdown_date){let e;var o,i,s=new Date,r=s.getFullYear();let t=DreamConfig.countdown_date;t.includes("T")&&(t=t.split("T")[0]),console.log("处理后的日期:",t),/^(0[1-9]|1[0-2])[-/](0[1-9]|[12]\d|3[01])$/.test(t)?(console.log("匹配月日格式"),[o,i]=t.split(/[-/]/).map(Number),(e=new Date(r,o-1,i))<s&&(e=new Date(r+1,o-1,i))):(console.log("匹配完整日期格式"),e=new Date(t)),console.log("目标日期:",e);var l,c,d,m=e-s,g=Math.ceil(m/864e5),h=new Date(r,0,1),f=new Date(r+1,0,1),u=Math.ceil((f-h)/864e5);let a;a=e.getFullYear()===r?(l=Math.ceil((s-h)/864e5),c=Math.ceil((e-h)/864e5),Math.round(l/c*100)):(d=Math.ceil((s-h)/864e5),Math.round(d/u*100)),a=Math.max(0,Math.min(100,a));var p=String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0");n={name:DreamConfig.countdown_name||"倒计时",days:Math.abs(g),percent:a+"%",percentage:a,date:p,isFuture:0<g},console.log("倒计时数据:",n)}var e=(()=>{const o=new Date,i={day:"今日",week:"本周",month:"本月",year:"本年"},e=e=>{var t=new Date,a=("day"===e?t.setHours(0,0,0,0):"week"===e?(t.setDate(t.getDate()-t.getDay()),t.setHours(0,0,0,0)):"month"===e?(t.setDate(1),t.setHours(0,0,0,0)):"year"===e&&(t.setMonth(0,1),t.setHours(0,0,0,0)),new Date(t)),n=("day"===e?a.setHours(23,59,59,999):"week"===e?(a.setDate(a.getDate()+6),a.setHours(23,59,59,999)):"month"===e?(a.setMonth(a.getMonth()+1,0),a.setHours(23,59,59,999)):"year"===e&&(a.setFullYear(a.getFullYear()+1,0,0),a.setHours(23,59,59,999)),"day"===e),a=a-t,a=n?a/36e5+1:a/864e5+1,t=o-t,n=n?t/36e5:t/864e5;return{name:i[e],total:a,passed:n,remaining:a-n,percentage:(n/a*100).toFixed(2)}};return{day:e("day"),week:e("week"),month:e("month"),year:e("year")}})();console.log("时间剩余数据:",e);let t="";t+='\n\t\t\t\t\t<div class="count-down">',n&&(t+=`
						<div class="count-right">
							<span class="text">距离</span>
							<span class="name">${n.name}</span>
							<span class="time">${n.days}</span>
							<span class="date">${n.date}</span>
						</div>`),t+='\n\t\t\t\t\t\t<div class="count-left">',Object.values(e).forEach(e=>{t+=`
							<div class="count-item">
								<div class="item-name">${e.name}</div>
								<div class="item-progress">
									<div class="progress-bar" style="width: ${e.percentage}%; opacity: ${e.percentage/100};"></div>
									<span class="percentage ${46<=parseFloat(e.percentage)?"many":""}">${e.percentage}%</span>
									<span class="remaining ${60<=parseFloat(e.percentage)?"many":""}">
										<span class="tip">还剩</span>
										${Math.floor(e.remaining)}
										<span class="tip">${"今日"===e.name?"小时":"天"}</span>
									</span>
								</div>
							</div>`}),t=t+"\n\t\t\t\t\t\t</div>"+"\n\t\t\t\t\t</div>",console.log("生成的HTML:",t),$(".aside-timelife").html(t),$(".count-down").on("mouseenter",function(){$(this).find(".count-left .remaining").css("opacity","1"),$(this).find(".count-left .remaining").css("transform","translateX(0)"),$(this).find(".count-left .percentage").css("opacity","0"),$(this).find(".count-left .percentage").css("transform","translateX(-10px)")}).on("mouseleave",function(){$(this).find(".count-left .remaining").css("opacity","0"),$(this).find(".count-left .remaining").css("transform","translateX(10px)"),$(this).find(".count-left .percentage").css("opacity","1"),$(this).find(".count-left .percentage").css("transform","translateX(0)")}),console.log("=== 人生倒计时初始化完成 ===")}else console.log("未找到aside-timelife元素，跳过执行");else console.log("未找到timelife元素，跳过执行")}catch(e){console.error("=== 人生倒计时初始化出错 ===",e)}},initSecurityLink(){DreamConfig.enable_security_link&&DreamConfig.security_link_url&&0!==DreamConfig.security_link_url.length&&$(document).on("click","a[href]:not([data-url-security]), hyperlink-inline-card[href]:not([data-url-security]), hyperlink-card[href]:not([data-url-security])",e=>{var t,a=$(e.currentTarget).attr("href");a&&(a.toLowerCase().startsWith("http://")||a.toLowerCase().startsWith("https://"))&&(t=a,[".pdf",".doc",".docx",".xls",".xlsx",".ppt",".pptx",".zip",".rar",".7z",".tar",".gz",".bz2",".dmg",".exe",".msi",".iso",".apk"].some(e=>t.toLowerCase().endsWith(e))?(e.preventDefault(),window.open(a,"_blank")):((e,t)=>{let o;(e=e.toLowerCase().trim()).startsWith("//")?e=window.location.protocol+e:e.startsWith("/")&&(e=window.location.origin+e),(e.startsWith("http://")||e.startsWith("https://"))&&(e=e.replace(/\/$/,""));try{o=new URL(e).hostname}catch(e){return!1}return t.some(e=>{var t,a,n;return e.startsWith("*.")?(a=(t=e.slice(2)).split("."),(n=o.split(".")).length>a.length&&n.slice(-a.length).join(".")===t):o===e})})(a,DreamConfig.security_link_whitelist)||(e.preventDefault(),window.open(DreamConfig.security_link_url+"?target="+encodeURIComponent(a),"_blank")))})},initGrayMode(){var e=sessionStorage.getItem("gray-mode"),t=sessionStorage.getItem("gray-mode-message"),a=sessionStorage.getItem("gray-mode-show");"true"===e&&t&&""!==t.trim()&&!a&&Qmsg&&(Qmsg.info(t),sessionStorage.setItem("gray-mode-show","true"))},initEffects(){Utils.isMobile()&&!DreamConfig.mobile_special_effects||(DreamConfig.cursor_move&&Utils.cachedScript(`${DreamConfig.theme_base}/js/cursor/move/${DreamConfig.cursor_move}.min.js?mew=`+DreamConfig.theme_version),DreamConfig.cursor_click&&Utils.cachedScript(`${DreamConfig.theme_base}/js/cursor/click/${DreamConfig.cursor_click}.min.js?mew=`+DreamConfig.theme_version),DreamConfig.effects_lantern_mode&&Utils.cachedScript(DreamConfig.theme_base+"/js/effects/lantern.min.js?mew="+DreamConfig.theme_version),DreamConfig.effects_sakura_mode&&Utils.cachedScript(DreamConfig.theme_base+"/js/effects/sakura.min.js?mew="+DreamConfig.theme_version),DreamConfig.effects_snowflake_mode&&Utils.cachedScript(DreamConfig.theme_base+"/js/effects/snowflake.min.js?mew="+DreamConfig.theme_version),DreamConfig.effects_universe_mode&&Utils.cachedScript(DreamConfig.theme_base+"/js/effects/universe.min.js?mew="+DreamConfig.theme_version),DreamConfig.effects_circle_magic_mode&&Utils.cachedScript(DreamConfig.theme_base+"/js/effects/circleMagic.min.js?mew="+DreamConfig.theme_version),DreamConfig.effects_quantum_silk_thread_mode&&Utils.cachedScript(DreamConfig.theme_base+"/js/effects/quantum.min.js?mew="+DreamConfig.theme_version),DreamConfig.effects_rain_mode&&Utils.cachedScript(DreamConfig.theme_base+"/js/effects/rain.min.js?mew="+DreamConfig.theme_version))},showThemeVersion(){window.logger(`%c页面加载耗时：${Math.round(performance.now())}ms | Theme By Dream2 Plus ${DreamConfig.theme_version} | https://github.com/hcjike/halo-theme-dream2.0-plus`,"color:#fff; background: linear-gradient(270deg, #986fee, #8695e6, #68b7dd, #18d7d3); padding: 8px 15px; border-radius: 0 15px 0 15px")},showBanner(e=location.pathname){var t=document.querySelector(".banner"),a=document.querySelector(".section");t&&("/"!==e?(t.classList.add("hidden"),a&&DreamConfig.header_fixed&&a.classList.add("section-top")):(t.classList.remove("hidden"),a&&DreamConfig.header_fixed&&a.classList.remove("section-top")))},playBannerVideo(){var t=document.querySelector(".banner"),a=document.querySelector(".banner video");function e(){try{var e;a.paused&&void 0!==(e=a.play())&&e.catch(function(e){console.log("视频播放失败:",e),t.style.backgroundImage=`url(${DreamConfig.banner_image})`})}catch(e){console.log("播放错误:",e)}}function n(e,t,a){function n(){a(),e.removeEventListener?e.removeEventListener(t,n):e.detachEvent&&e.detachEvent("on"+t,n)}e.addEventListener?e.addEventListener(t,n):e.attachEvent&&e.attachEvent("on"+t,n)}a&&t&&(a.loop=!0,a.muted=!0,a.setAttribute("playsinline",""),a.setAttribute("webkit-playsinline",""),a.addEventListener("ended",function(){a.currentTime=0,e()},!1),n(document,"click",e),n(document,"touchend",e),e())},initCalendar(){try{if(console.log("=== 开始执行日历初始化 ==="),console.log("calendar元素存在:",0<$(".calendar").length),console.log("aside-calendar元素存在:",0<$(".aside-calendar").length),console.log("当前时间:",new Date),$(".calendar").length)if($(".aside-calendar").length){console.log("找到所有必要元素，开始执行日历计算");var e=new Date,a=e.getFullYear(),n=e.getMonth(),o=e.getDate(),i=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],s=["日","一","二","三","四","五","六"],r=new Date(a,n,1).getDay(),l=new Date(a,n+1,0).getDate();let t="";t+=`
												<div class="calendar-container">
													<div class="calendar-header">
														<h3>${a}年 ${i[n]}</h3>
													</div>
													<div class="calendar-weekdays">`,s.forEach(e=>{t+=`
														<div class="calendar-weekday">${e}</div>`}),t+='\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="calendar-days">';for(let e=0;e<r;e++)t+='\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="calendar-day empty"></div>';for(let e=1;e<=l;e++)t+=`
														<div class="calendar-day ${e===o?"today":""}">
															${e}
														</div>`;t+="\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>",console.log("生成的日历HTML:",t),$(".aside-calendar").html(t),console.log("=== 日历初始化完成 ===")}else console.log("未找到aside-calendar元素，跳过执行");else console.log("未找到calendar元素，跳过执行")}catch(e){console.error("=== 日历初始化出错 ===",e)}}};window.commonContext=t;{const a=["initCarousel","sparkInput","websiteTime","playBannerVideo","initEffects","iniTaskItemDisabled","initTimeCount","initCalendar"],n=["showThemeVersion"];Object.keys(t).forEach(e=>!a.includes(e)&&!n.includes(e)&&t[e]()),document.addEventListener("DOMContentLoaded",function(){$("html").addClass("loaded"),a.forEach(e=>t[e]&&t[e]())}),window.addEventListener("load",function(){n.forEach(e=>t[e]&&t[e]()),$("html").addClass("ready")})}})();